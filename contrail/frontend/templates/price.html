{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block css %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css"></script>
<link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
{% endblock %}

<!-- SLIDER SOURCE -->
<!-- https://codepen.io/anon/pen/rbpqME -->

{% block content %}
<div class="wrapper">
  <!-- Sidebar -->
  <nav id="sidebar">
    <form method="POST">
      {% csrf_token %}
      <h4><strong>Set Attributes</strong></h4>

      <div class="form-group">
        <div id="div_id_amazon_web_services" class="form-check">
          <label for="id_amazon_web_services" class="form-check-label">
            <input type="checkbox" name="amazon_web_services" class="checkboxinput form-check-input" id="id_amazon_web_services" checked="">
            Amazon web services
          </label>
        </div>
      </div>

      <div class="form-group">
        <div id="div_id_google_cloud_platform" class="form-check">
          <label for="id_google_cloud_platform" class="form-check-label">
            <input type="checkbox" name="google_cloud_platform" class="checkboxinput form-check-input" disabled="" id="id_google_cloud_platform">
            Google cloud platform
          </label>
        </div>
      </div>

      <div class="form-group">
        <div id="div_id_microsoft_azure" class="form-check">
          <label for="id_microsoft_azure" class="form-check-label">
            <input type="checkbox" name="microsoft_azure" class="checkboxinput form-check-input" disabled="" id="id_microsoft_azure">
            Microsoft azure
          </label>
        </div>
      </div>

      <div id="div_id_operating_system" class="form-group">
        <label for="id_operating_system" class="col-form-label ">
                Operating system
        </label>
        <div class="">
          <select name="operating_system" class="select form-control" id="id_operating_system"> <option value="" selected="">All</option> <option value="Linux">Linux</option> <option value="RHEL">RHEL</option> <option value="SLES">SLES</option> <option value="Windows">Windows</option> <option value="Windows with SQL Standard">Windows with SQL Standard</option> <option value="Windows with SQL Web">Windows with SQL Web</option> <option value="Windows with SQL Enterprise">Windows with SQL Enterprise</option> <option value="Linux with SQL Standard">Linux with SQL Standard</option> <option value="Linux with SQL Web">Linux with SQL Web</option> <option value="Linux with SQL Enterprise">Linux with SQL Enterprise</option>
          </select>
        </div>
      </div>

      <div id="div_id_region" class="form-group">
        <label for="id_region" class="col-form-label ">
           Region
        </label>
        <div class="">
          <select name="region" class="select form-control" id="id_region"> <option value="" selected="">All</option> <option value="US East (N. Virgina)">US East (N. Virgina)</option> <option value="US East (Ohio)">US East (Ohio)</option> <option value="US West (Norther California)">US West (Norther California)</option> <option value="US West (Oregon)">US West (Oregon)</option> <option value="Asia Pacific (Mumbai)">Asia Pacific (Mumbai)</option> <option value="Asia Pacific (Seoul)">Asia Pacific (Seoul)</option> <option value="Asia Pacific (Singapore)">Asia Pacific (Singapore)</option> <option value="Asia Pacific (Sydney)">Asia Pacific (Sydney)</option> <option value="Asia Pacific (Tokyo)">Asia Pacific (Tokyo)</option> <option value="Canada (Central)">Canada (Central)</option> <option value="EU (Frankfurt)">EU (Frankfurt)</option> <option value="EU (Ireland)">EU (Ireland)</option> <option value="EU (London)">EU (London)</option> <option value="EU (Paris)">EU (Paris)</option> <option value="EU (Stockholm)">EU (Stockholm)</option> <option value="South America (Sao Paulo)">South America (Sao Paulo)</option> <option value="AWS GovCloud (US-East)">AWS GovCloud (US-East)</option> <option value="AWS GovCloud (US-West)">AWS GovCloud (US-West)</option>
          </select>
        </div>
      </div>

      <label class="form-check-label">Price Type</label>

      <div class="form-group">
        <div id="div_id_on_demand" class="form-check">
          <label for="id_on_demand" class="form-check-label">
            <input type="checkbox" name="on_demand" class="checkboxinput form-check-input" id="id_on_demand" checked="">
                On demand
          </label>
        </div>
      </div>

      <div class="form-group">
        <div id="div_id_reserved" class="form-check">
          <label for="id_reserved" class="form-check-label">
            <input type="checkbox" name="reserved" class="checkboxinput form-check-input" id="id_reserved" checked="">
                Reserved
          </label>
        </div>
      </div>

      <div class="form-group">
        <div id="div_id_spot" class="form-check">
          <label for="id_spot" class="form-check-label">
            <input type="checkbox" name="spot" class="checkboxinput form-check-input" id="id_spot" checked="">
                    Spot
          </label>
        </div>
      </div>


      <label for="id_memory" class="col-form-label ">
          Memory
      </label>
      <div class="range-slider">
          <input type="text" class="memory-range-slider" value="" />
      </div>

      <div class="extra-controls form-inline">
        <div class="form-group">
          <input type="text" id="id_memory_from" class="memory-input-from form-control" name="memory_from" value="0" style="width: 80px; margin-right: 30px;" />
          <input type="text" id="id_memory_to" class="memory-input-to form-control" name="memory_to" value="0" style="width: 80px;" />
        </div>
      </div><br>


      <label for="id_vcpu" class="col-form-label ">
          vCPUs
      </label>
      <div class="range-slider">
          <input type="text" class="vcpu-range-slider" value="" />
      </div>

      <div class="extra-controls form-inline">
        <div class="form-group">
          <input type="text" id="id_vcpu_from" class="vcpu-input-from form-control" name="vcpu_from" value="0" style="width: 80px; margin-right: 30px;" />
          <input type="text" id="id_vcpu_to" class="vcpu-input-to form-control" name="vcpu_to" value="0" style="width: 80px;" />
        </div>
      </div><br>

      <label for="id_price" class="col-form-label ">
          Price Upfront
      </label>
      <div class="range-slider">
          <input type="text" class="price-range-slider" value="" />
      </div><br>

      <div class="extra-controls form-inline">
        <div class="form-group">
          <input type="text" id="id_price_from" class="price-input-from form-control" name="price_from" value="0" style="width: 80px; margin-right: 30px;" />
          <input type="text" id="id_price_to" class="price-input-to form-control" name="price_to" value="0" style="width: 80px;" />
        </div>
      </div>


      <label for="id_pricehr" class="col-form-label ">
          Price Hourly
      </label>
      <div class="range-slider">
          <input type="text" class="pricehr-range-slider" value="" />
      </div>

      <div class="extra-controls form-inline">
        <div class="form-group">
          <input type="text" id="id_pricehr_from" class="pricehr-input-from form-control" name="pricehr_from" value="0" style="width: 80px; margin-right: 30px;" />
          <input type="text" id="id_pricehr_to" class="pricehr-input-to form-control" name="pricehr_to" value="0" style="width: 80px;" />
        </div>
      </div>

      <br>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>



      <!--
        <select name="{{ form.operating_system.name }}" class="form-control" id="{{ form.operating_system.id_for_label }}">
          {% for x,y in form.fields.operating_system.choices %}
              <option value="{{ x }}"{% if form.fields.operating_system.value == x %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>

        <select name="{{ form.region.name }}" class="form-control" id="{{ form.region.id_for_label }}">
          {% for x,y in form.fields.region.choices %}
              <option value="{{ x }}"{% if form.fields.region.value == x %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>
      -->
    </nav>

    <!-- Page Content  -->
    <div id="content">
        <br><br>
        <button type="button" id="sidebarCollapse" class="btn btn-info">
            <i class="fas fa-align-left"></i>
            <span>Set Attributes</span>
        </button>
        <br><br>


        <table id="instances" class="table table-striped table-bordered" style="width:100%">
          <thead>
              <tr>
                  <th>Instance</th>
                  <!-- <th>Provider</th> -->
                  <th>Region</th>
                  <th>vCPUs</th>
                  <th>Memory (GiB)</th>
                  <th>Clock Speed</th>
                  <th>Price Type</th>
                  <th>Price Upfront</th>
                  <th>Price Per Hour</th>
              </tr>
          </thead>
          <tbody>

          {% for instance in instances %}
            <tr>
              <td><a href="{{ instance.url }}">{{ instance.instanceType }}</a></td>
              <!-- <td>{{ instance.provider }}</td> -->
              <td>{{ instance.region }}</td>
              <td>{{ instance.vcpus }}</td>
              <td>{{ instance.memory }}</td>
              <td>{{ instance.clockSpeed }}</td>
              <td>{{ instance.priceType }}</td>
              <td>{% if instance.priceUpfront %}${{ instance.priceUpfront | floatformat:3 }}{% else %}none{% endif %}</td>
              <td>${{ instance.pricePerHour }}</td>
            </tr>
            {% endfor %}

          </tbody>
          <tfoot>
              <tr>
                <th>Instance</th>
                <!-- <th>Provider</th> -->
                <th>Region</th>
                <th>Operating System</th>
                <th>VCPUs</th>
                <th>Memory</th>
                <!-- <th>ECU</th> -->
                <th>Price Type</th>
                <th>Price</th>
                <th>Price Unit</th>
              </tr>
          </tfoot>
      </table>

      <br>

      <button id="comparebutton" class="btn btn-info">
          Compare
      </button>

      <div class="line"></div>

      <div id="comparepop" class="compareview">
        <div class="compare-container">
          <span class="close">&times;</span>
          <table id="instancesComp" class="table table-striped table-hover table-bordered comparetable" style="width:100%">
            <thead>
              <tr>
                <th style="width:40%">Specifications</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th>Region</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>vCPUs</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>Memory (GiB)</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>Clock Speed</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>Price Type</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>Price Upfront</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <th>Price Per Hour</th>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
        </table>
      </div>
    </div>

  </div>

</div>



{% endblock %}


{% block script %}

<!-- SIDE BAR -->
<script type="text/javascript">
    $(document).ready(function () {
        $("#sidebar").mCustomScrollbar({
            theme: "minimal"
        });

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar, #content').toggleClass('active');
            $('.collapse.in').toggleClass('in');
            $('a[aria-expanded=true]').attr('aria-expanded', 'false');
        });
    });
</script>

<!-- SLIDER -->
<!-- https://codepen.io/anon/pen/rbpqME -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.3/jquery.min.js" ></script> -->
<script src="{% static 'js/priceSlider.js' %}" ></script>
<script src="{% static 'js/priceHourlySlider.js' %}" ></script>
<script src="{% static 'js/memorySlider.js' %}" ></script>
<script src="{% static 'js/vcpuSlider.js' %}" ></script>



<!-- BOOTSTRAP TABLE -->
<script type="text/javascript">
  $(document).ready(function() {
    $('#instances').DataTable( {
        // "paging":   false,
        "ordering": true,
        // "info":     false,
        "columns": [
            {"type": "string"},
            {"type": "string"},
            {"type": "string"},
            {"type": "num"},
            {"type": "num"},
            {"type": "string"},
            {"type": "num"},
            {"type": "string"},
        ]
    } );
  } );

</script>

<!-- SELECTION -->
<script type="text/javascript">
  $(document).ready(function() {
  	 var table = $('#instances').DataTable();
     table.selectedProducts = 0;

    // selecting products
    $('#instances tbody').on( 'click', 'tr', function () {
      if ($(this).hasClass('selected')) {
        $(this).removeClass('selected');
        table.selectedProducts -= 1;
      } else if (table.selectedProducts < 3 && !$(this).hasClass('selected')) {
          $(this).addClass('selected');
          table.selectedProducts += 1;
      } else if (table.selectedProducts >= 3) {
        alert("Please only select up to 3 instances to be compared.");
      }
    } );

  } );
</script>

<!-- COMPARISON -->
<script type="text/javascript">
  var comparePop = document.getElementById('comparepop');
  var btn = document.getElementById('comparebutton');
  var span = document.getElementsByClassName("close")[0];
  var compareTable = document.getElementById('instancesComp');
  var numSpecs = document.getElementById('instances').rows[0].cells.length;
  btn.onclick = function() {
    comparePop.style.display = "block";
    var selectedRows = document.querySelectorAll(".selected");
    var numSelected = selectedRows.length;

    if (numSelected <= 1) {
      alert("Please select more than 1 instance to be compared.");
      document.getElementById("comparepop").style.display = "none";
    }
    else {
      for (var i = 1; i <= numSelected; i++) {
        for (var j = 0; j < numSpecs; j++) {
          compareTable.rows[j].cells[i].append(selectedRows[i-1].cells[j].innerText);
        }
      }
    }
 }
  span.onclick = function() {
    comparePop.style.display = "none";
    var selectedRows = document.querySelectorAll(".selected");
    var numSelected = selectedRows.length;
    for (var i = 1; i <= numSelected; i++) {
      for (var j = 0; j < numSpecs; j++) {
        compareTable.rows[j].cells[i].innerHTML = "";
      }
    }
  }
  window.onclick = function(event) {
    if (event.target == comparePop) {
    comparePop.style.display = "none";
      var selectedRows = document.querySelectorAll(".selected");
      var numSelected = selectedRows.length;
      for (var i = 1; i <= numSelected; i++) {
        for (var j = 0; j < numSpecs; j++) {
          compareTable.rows[j].cells[i].innerHTML = "";
        }
      }
    }
  }
</script>



{% endblock %}
